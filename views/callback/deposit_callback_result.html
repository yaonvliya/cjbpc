<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no,email=no,address=no"/>
    <title>富友回调结果 - 车聚宝</title>
    <script src="../../js/ismobile.js"></script>
    <link rel="shortcut icon" href="../../img/favicon.ico"/>
    <link rel="stylesheet" type="text/css" href="../../plugins/layui/css/layui.css?v=2.1.5"/>
    <link rel="stylesheet" type="text/css" href="../../iconfont/iconfont.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/base.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/common.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/user.css"/>

</head>
<body>
<!------公用头部------>
<header id="header"></header>

<div class="call-wrapper">
	<div class="call-box">
		<p class="p1"><i id="icon" class="iconfont va-m"></i><span class="va-m result"></span></p>
		<p class="p2"><a href="#" class="mr20 hide">立即投资</a><a id="myAccount" href="../user/user_index.html">返回我的账户</a></p>
		<p class="call-cue"></p>
	</div>
</div>


<!------公用底部------>
<footer class="footer" id="footer"></footer>

<script src="../../js/jquery.min.js"></script>
<script src="../../plugins/layui/layui.js?v=2.1.5"></script>
<script src="../../js/jquery.cookie.js"></script>
<script src="../../properties/host-config.properties.js"></script>
<script src="../../js/api-config.js"></script>
<script src="../../js/base-utils.js"></script>
<script src="../../js/base-utils.api.js"></script>
<script>
	var interval, fuiouType;
	var message = $('.result');
	var account = $('#myAccount');
	var cue = $('.call-cue');
	$(document).ready(function () {
		$("#header").load("../../views/common/header.html");
		$("#footer").load("../../views/common/footer.html");

		var params = location.hash;
		// 初始化layer
		layui.use(['layer'], function () {
			layer = layui.layer;

			//判断是否登录，未登录则跳转到登录页面
			commonAPIUtil.isLogin();
			if(params){
				params = params.substring(1, params.length);
				var data = params.split(',');
				fuiouType = data[1];
				var param = {requestNo:data[0], fuiouBizType: data[1]};
				interval = window.setInterval(loadResult(param), 500);
			}

			switch (fuiouType){
				case $_GLOBAL.fyType.PERSONAL_REALNAME: case $_GLOBAL.fyType.ENTERPRISE_REALNAME: case $_GLOBAL.fyType.BIND_CARD:
					cue.text("温馨提示：投资的项目在满标放款当日开始计息。");
					account.prev().show().text("立即投资").attr("href", "../invest/invest.html");
					break;
				case $_GLOBAL.fyType.UNBIND_CARD:
					cue.text("温馨提示：在绑定新的银行卡前不能提现。");
					account.prev().show().text("绑定银行卡").attr("href", "../user/user_index.html");
					break;
				case $_GLOBAL.fyType.MODIFY_TRADE_PASS: case $_GLOBAL.fyType.RESET_TRADE_PASS:
					cue.text("温馨提示：请妥善保管好您的密码哦！");
					break;
				case $_GLOBAL.fyType.MODIFY_BANK_MOBILE:
                    cue.text("温馨提示：更改银行卡预留手机号码成功。");
                    break;
				case $_GLOBAL.fyType.QUICK_RECHARGE: case $_GLOBAL.fyType.NET_SLIVER_RECHARGE:
					cue.text("温馨提示：充值后必须购买投资产品才能获得收益。");
			    	account.prev().show().text("继续充值").attr("href", "../user/user_index.html#recharge");
					break;
				case $_GLOBAL.fyType.WITHDRAW:
                    cue.text("温馨提示：提现金额T+1个工作日到账。");
                    account.prev().show().text("继续提现").attr("href", "../user/user_index.html#withdraw");
                    break;
				case $_GLOBAL.fyType.AUTHORIZATION:
					cue.text("温馨提示：授权成功。");
					break;
				case $_GLOBAL.fyType.CLOSE_USER:
					cue.text("温馨提示：销户成功。");
					setTimeout(function () {
                        CookieUtil.clearAllCookie();
                        $_GLOBAL.jumpToIndex();
                    }, 2000);
					break;
                default :
					cue.text("温馨提示：这笔交易失败，请返回个人中心重新尝试。");
					break;
            }
			if(StringUtil.isContains(params, "RECHARGE") || StringUtil.isContains(params, "authorization")){
				var url = CookieUtil.getCookie("baoFu-callBack-URL");
				setTimeout(function () {
					CookieUtil.deleteCookie("baoFu-callBack-URL");
				}, 2000);

				if(url){
					account.prev().show().text("返回投资").attr("href", url);
				}
			}

		});
	});

	function loadResult(data) {
		var result = AjaxUtil.ajaxPost(userProfileApiUrl.baoFuResult, JSON.stringify(data));
		if ('20000' == result.code) {
			if(result.data) {
				window.clearInterval(interval);
				message.text(result.data.res_desc);
				if(result.data.res_flag){
					$("#icon").addClass("icon-zhengque");
				} else {
					$("#icon").addClass("icon-cuowu");
				}
			}
		} else if ('40404' == result.code || '40405' == result.code) {
			layer.msg('由于您长时间未操作，请重新登录。', {time:2000}, function () {
				CookieUtil.clearAllCookie();
				$_GLOBAL.jumpToLogin();
			});
		} else {
			message.text(result.message);
			$("#icon").addClass("icon-cuowu");
		}
	}
</script>
</body>
</html>
